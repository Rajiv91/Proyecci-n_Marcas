%function script()
%Puntos seleccionados en pixeles
imgPts=[815, 800, 780, 754, 957, 959, 957, 959, 1099, 1114, 1134, 1160;
        880, 924, 979, 1054, 878, 927, 979, 1057, 881, 928, 982, 1058;
  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1];

  scnPts = [-0.4, -0.4, -0.4, -0.4, 0, 0, 0, 0, 0.4, 0.4, 0.4, 0.4;
  0, 0.4, 0.8, 1.2, 0, 0.4, 0.8, 1.2, 0, 0.4, 0.8, 1.2;
  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1];

K = [616.1640014648438, 0, 325.5280151367188;
  0, 616.8200073242188, 228.6600036621094;
  0, 0, 1];
  Kinv=inv(K);
  %se pasa a m
  imgPtsm=Kinv*imgPts;
  %La homografía es de scp a imp

H=[0.5974552216307064, -0.2693865528689454, 1.021499284760178;
  0.01412921045245138, -0.1049636724685632, 1.063382624060787;
  0.005882126229172053, -0.2630310520556895, 1];

  imp=[imgPts(1:2,:)];
  scp=[scnPts(1:2,:)];
  scp2=[scp;ones(1,12)];
  mapeoIm=H*scp2;
  %mapeoIm2
  %Deshomog...
  for i=1: size(mapeoIm,2)
    mapeoIm(:,i)=mapeoIm(1:3,i)/mapeoIm(3,i);
  end
%Distancia entre los 2 conjuntos de puntos
temp=mapeoIm;
dist1=[];
  for i=1: size(mapeoIm,2)
    temp(1:3,i)=(mapeoIm(1:3,i)-imgPtsm(1:3,i));
    dist1(i)=norm(temp(:,i));
  end

Dummy = [1, 0, 0, 0;
  0, 1, 0, 0;
  0, 0, 1, 0];

R= [0.9996387701129884, 0.02010707151713348, -0.01783353475890288;
  0.02387739970981716, -0.3598367780173961, 0.9327096884717971;
  0.01233689872252064, -0.932798584294093, -0.3601868988023387];

T= [1.766323414619636;
  1.818117362309279;
  1.72238404558488];
G= [0.9996387701129884, 0.02010707151713348, -0.01783353475890288, 1.766323414619636;
  0.02387739970981716, -0.3598367780173961, 0.9327096884717971, 1.818117362309279;
  0.01233689872252064, -0.932798584294093, -0.3601868988023387, 1.72238404558488;
  0, 0, 0, 1];


%intersecciones 3d en el plano

intersec=[1.358201026916504, 1.186445236206055, 1.011417031288147, 0.8292047381401062, 1.772942900657654, 1.584187626838684, 1.414847493171692, 1.227892279624939, 2.170093774795532, 1.98050582408905, 1.81283175945282, 1.625508189201355;
  1.805434942245483, 1.736889719963074, 1.668088555335999, 1.595548987388611, 1.821170926094055, 1.744552135467529, 1.679389834403992, 1.603907704353333, 1.828293085098267, 1.754753351211548, 1.687413215637207, 1.61379337310791;
  1.709749579429626, 1.540754556655884, 1.371258974075317, 1.192437648773193, 1.729963779449463, 1.540903687477112, 1.380549192428589, 1.194343328475952, 1.728742361068726, 1.547697782516479, 1.381620764732361, 1.200255632400513;
  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1];
  
  %Rotamos y trasladamos 12 los puntos establecidos del rectángulo
  scnPtsRot=G*scnPts;
  %Calculamos el error
temp2=intersec;
dist2=[];
  for i=1: size(intersec,2)
    temp2(1:4,i)=(intersec(1:4,i)-scnPtsRot(1:4,i));
    dist2(i)=norm(temp2(:,i));
  end

  


%end
